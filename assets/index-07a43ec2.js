import{r as T,i as x,w as Z,c as R,u as h,a as ee,b as te,d as E,o as y,e as S,f as d,n as ne,t as w,g as I,h as C,F as B,j as U,p as z,k as D,l as L,m as re,T as $,q as A,s as G,v as oe,x as ae,y as se,z as ie,A as le}from"./vendor-f2f6c7d8.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function i(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=i(e);fetch(e.href,n)}})();const ce="modulepreload",ue=function(t){return"/"+t},N={},O=function(s,i,o){if(!i||i.length===0)return s();const e=document.getElementsByTagName("link");return Promise.all(i.map(n=>{if(n=ue(n),n in N)return;N[n]=!0;const r=n.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(!!o)for(let u=e.length-1;u>=0;u--){const l=e[u];if(l.href===n&&(!r||l.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${a}`))return;const c=document.createElement("link");if(c.rel=r?"stylesheet":ce,r||(c.as="script",c.crossOrigin=""),c.href=n,document.head.appendChild(c),r)return new Promise((u,l)=>{c.addEventListener("load",u),c.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>s())};function de(t={}){const{immediate:s=!1,onNeedRefresh:i,onOfflineReady:o,onRegistered:e,onRegisteredSW:n,onRegisterError:r}=t;let a,f,c;const u=async(p=!0)=>{await f,await(c==null?void 0:c())};async function l(){if("serviceWorker"in navigator){const{Workbox:p}=await O(()=>import("./workbox-window.prod.es5-295a6886.js"),[]);a=new p("/sw.js",{scope:"/",type:"classic"}),c=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let m=!1;const _=()=>{m=!0,a==null||a.addEventListener("controlling",g=>{g.isUpdate&&window.location.reload()}),i==null||i()};a.addEventListener("installed",g=>{typeof g.isUpdate>"u"?typeof g.isExternal<"u"?g.isExternal?_():!m&&(o==null||o()):g.isExternal?window.location.reload():!m&&(o==null||o()):g.isUpdate||o==null||o()}),a.addEventListener("waiting",_),a.addEventListener("externalwaiting",_)}a.register({immediate:s}).then(m=>{n?n("/sw.js",m):e==null||e(m)}).catch(m=>{r==null||r(m)})}}return f=l(),u}let P;function fe(){if(navigator.serviceWorker){const t=de({onRegistered(s){P=s,console.log("pwa registered")},onNeedRefresh(){console.log("pwa need update"),t()},onRegisterError(s){console.log("pwa register failed",s)}})}else console.log("pwa 不支持")}async function W(){return navigator.serviceWorker?P==null?void 0:P.unregister():!1}const me=(t,s)=>{const i=t[s];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((o,e)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(e.bind(null,new Error("Unknown variable dynamic import: "+s)))})};function pe(t){if(t.__esModule)return t;var s=t.default;if(typeof s=="function"){var i=function o(){if(this instanceof o){var e=[null];e.push.apply(e,arguments);var n=Function.bind.apply(s,e);return new n}return s.apply(this,arguments)};i.prototype=s.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var e=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(i,o,e.get?e:{enumerable:!0,get:function(){return t[o]}})}),i}(function t(s){function i(e,n,r){var a,f={};if(Array.isArray(e))return e.concat(n);for(a in e)f[r?a.toLowerCase():a]=e[a];for(a in n){var c=r?a.toLowerCase():a,u=n[a];f[c]=c in f&&typeof u=="object"?i(f[c],u,c=="headers"):u}return f}function o(e,n,r,a,f){var c=typeof e!="string"?(n=e).url:e,u={config:n},l=i(s,n),p={};a=a||l.data,(l.transformRequest||[]).map(function(m){a=m(a,l.headers)||a}),l.auth&&(p.authorization=l.auth),a&&typeof a=="object"&&typeof a.append!="function"&&typeof a.text!="function"&&(a=JSON.stringify(a),p["content-type"]="application/json");try{p[l.xsrfHeaderName]=decodeURIComponent(document.cookie.match(RegExp("(^|; )"+l.xsrfCookieName+"=([^;]*)"))[2])}catch{}return l.baseURL&&(c=c.replace(/^(?!.*\/\/)\/?/,l.baseURL+"/")),l.params&&(c+=(~c.indexOf("?")?"&":"?")+(l.paramsSerializer?l.paramsSerializer(l.params):new URLSearchParams(l.params))),(l.fetch||fetch)(c,{method:(r||l.method||"get").toUpperCase(),body:a,headers:i(l.headers,p,!0),credentials:l.withCredentials?"include":f}).then(function(m){for(var _ in m)typeof m[_]!="function"&&(u[_]=m[_]);return l.responseType=="stream"?(u.data=m.body,u):m[l.responseType||"text"]().then(function(g){u.data=g,u.data=JSON.parse(g)}).catch(Object).then(function(){return(l.validateStatus?l.validateStatus(m.status):m.ok)?u:Promise.reject(u)})})}return s=s||{},o.request=o,o.get=function(e,n){return o(e,n,"get")},o.delete=function(e,n){return o(e,n,"delete")},o.head=function(e,n){return o(e,n,"head")},o.options=function(e,n){return o(e,n,"options")},o.post=function(e,n,r){return o(e,r,"post",n)},o.put=function(e,n,r){return o(e,r,"put",n)},o.patch=function(e,n,r){return o(e,r,"patch",n)},o.all=Promise.all.bind(Promise),o.spread=function(e){return e.apply.bind(e,e)},o.CancelToken=typeof AbortController=="function"?AbortController:Object,o.defaults=s,o.create=t,o})();function ge(t,s){return s=s||{},new Promise(function(i,o){var e=new XMLHttpRequest,n=[],r=[],a={},f=function(){return{ok:(e.status/100|0)==2,statusText:e.statusText,status:e.status,url:e.responseURL,text:function(){return Promise.resolve(e.responseText)},json:function(){return Promise.resolve(e.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([e.response]))},clone:f,headers:{keys:function(){return n},entries:function(){return r},get:function(u){return a[u.toLowerCase()]},has:function(u){return u.toLowerCase()in a}}}};for(var c in e.open(s.method||"get",t,!0),e.onload=function(){e.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(u,l,p){n.push(l=l.toLowerCase()),r.push([l,p]),a[l]=a[l]?a[l]+","+p:p}),i(f())},e.onerror=o,e.withCredentials=s.credentials=="include",s.headers)e.setRequestHeader(c,s.headers[c]);e.send(s.body||null)})}const ve=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"})),V=pe(ve);self.fetch||(self.fetch=V.default||V);const he={Romance:"恋爱","Love Polygon":"恋爱","Romantic Subtext":"恋爱","Sci-Fi":"科幻",Mecha:"科幻",Isekai:"异世界",Fantasy:"奇幻",Reincarnation:"奇幻","Super Power":"奇幻",Supernatural:"奇幻","Time Travel":"奇幻",Mythology:"奇幻","Mahou Shoujo":"奇幻",Sports:"运动","Team Sports":"运动","Combat Sports":"运动",Racing:"运动",Adventure:"冒险",Action:"战斗",Comedy:"搞笑","Gag Humor":"搞笑",Music:"音乐","Idols (Female)":"偶像","Idols (Male)":"偶像",Showbiz:"偶像","Organized Crime":"犯罪",Delinquents:"犯罪",Suspense:"悬疑",Mystery:"悬疑","Strategy Game":"悬疑",Detective:"悬疑","Performing Arts":"艺术","Visual Arts":"艺术",Crossdressing:"艺术",Erotica:"福利",Ecchi:"福利",Hentai:"涩涩",Iyashikei:"治愈","Slice of Life":"日常",Seinen:"青春",School:"校园",Workplace:"职场",CGDCT:"萌系",Harem:"后宫","Girls Love":"GL","Boys Love":"BL","Reverse Harem":"",Historical:"历史",Military:"军事","Avant Garde":"前卫","Award Winning":"获奖",Psychological:"心理",Horror:"恐怖",Gore:"血腥",Shounen:"",Shoujo:"",Josei:"",Parody:"",Childcare:"",Survival:"",Gourmet:"",Kids:"",Pets:"",Vampire:"",Medical:"","Magical Sex Shift":"",Samurai:"",Anthropomorphic:"",Educational:"","Martial Arts":"",Space:"","Video Game":"","High Stakes Game":"","Otaku Culture":"","Adult Cast":"",Drama:""};function _e(...t){return t.reduce((s,i)=>s+Number(i),0)}function be(...t){const s=t.filter(i=>Number(i));return(_e(...s)/s.length).toFixed(2)}function ye(t,s){const i=T([]);async function o(){const n=Number(h(t));i.value=(await me(Object.assign({"../../../data-rank/rank-2021.json":()=>O(()=>import("./rank-2021-e0e27ced.js"),[]),"../../../data-rank/rank-2022.json":()=>O(()=>import("./rank-2022-8da34090.js"),[]),"../../../data-rank/rank-2023.json":()=>O(()=>import("./rank-2023-e374841e.js"),[])}),`../../../data-rank/rank-${n}.json`)).default}return x(t)||x(s)?Z(o):o(),R(()=>{const n=h(s);return i.value.map(r=>{var l,p,m,_;let a=r.bgm.cover;(a=="https:/img/no_icon_subject.png"||!a)&&(a=r.mal.cover);const f=[...new Set(r.mal.genres.map(g=>{const k=he[g];return k==null&&console.log("标签未翻译",g),k}).filter(Boolean))],c=be(...[r.mal.score,r.bgm.score,n=="3"&&((l=r.anikore)==null?void 0:l.score)].filter(Boolean)),u=r.mal.userCount+r.bgm.userCount+((p=r.anikore)==null?void 0:p.userCount);return{title:r.bgm.cnTitle||r.bgm.title,jaTitle:r.mal.title||r.mal.jaTitle||r.bgm.title,cover:a,malScore:r.mal.score,bgmScore:r.bgm.score,anikoreScore:(m=r.anikore)==null?void 0:m.score,avgScore:c,userCount:u,genres:f,malId:r.mal.id,bgmId:r.bgm.id,anikoreId:(_=r.anikore)==null?void 0:_.id}}).filter(r=>{if(n=="3")return r.anikoreScore&&r.bgmScore&&r.malScore;if(n=="2")return r.bgmId&&r.malId}).sort((r,a)=>Number(a.avgScore)-Number(r.avgScore))})}function ke(t,s){const i=R(()=>{var r;const e=[],n={};return t.value.forEach(a=>{a.genres.forEach(f=>{n[f]=(n[f]||0)+1})}),Object.keys(n).forEach(a=>{e.push({text:`${a} (${n[a]})`,value:a,count:n[a]})}),e.sort((a,f)=>f.count-a.count),[{text:`全部 (${((r=t.value)==null?void 0:r.length)||0})`,value:"all"}].concat(e)});return[R(()=>{var n;const e=h(s);return((n=i.value[0])==null?void 0:n.value)==e?t.value:t.value.filter(r=>r.genres.includes(e))}),i]}function M(t,s){const i=ee(),o=te();return R({get(){const e=i.params[t];return e==""?s:e},set(e){o.replace({params:{...i.params,[t]:e}})}})}function Se(t){return t==null?void 0:t.replace("/pic/","/r/400/pic/")}function we(t){return{backgroundImage:`url(${Se(t)})`}}const q=t=>(z("data-v-b10ceeed"),t=t(),D(),t),Ce={class:"card"},Le={class:"cover"},xe={class:"info"},Re={class:"rank"},Ae={class:"box"},Oe={class:"title-holder"},Pe=["innerHTML"],Ee=["innerHTML"],je={class:"score-avg"},Me=q(()=>d("span",{class:"label"},"综合",-1)),Te={class:"score-list"},$e=["href"],Ie=["href"],Ne=["href"],Ve={class:"tag-list"},He=q(()=>d("span",{class:"label"},"类型",-1)),Be={class:"tag van-hairline--surround"},Ue=E({__name:"AnimeCard",props:["data","rank","bigCover"],setup(t){return(s,i)=>(y(),S("div",Ce,[d("div",Le,[d("div",{class:"cover-inner",style:ne(t.bigCover?{backgroundImage:`url(${t.data.cover})`}:h(we)(t.data.cover))},null,4)]),d("div",xe,[d("p",Re,w(t.rank),1),d("div",Ae,[d("div",Oe,[d("div",{class:"title ellipsis-2",innerHTML:t.data.title},null,8,Pe),d("div",{class:"title-ja ellipsis",innerHTML:t.data.jaTitle},null,8,Ee)]),d("p",je,[Me,d("strong",null,w(t.data.avgScore),1),I(" {{ data.userCount }} ")]),d("div",Te,[d("a",{href:`https://myanimelist.net/anime/${t.data.malId}`,target:"_blank"},[C(" MAL"),d("strong",null,w(Number(t.data.malScore).toFixed(2)),1)],8,$e),d("a",{href:`https://bgm.tv/subject/${t.data.bgmId}`,target:"_blank"},[C(" BGM"),d("strong",null,w(Number(t.data.bgmScore).toFixed(2)),1)],8,Ie),t.data.anikoreId?(y(),S("a",{key:0,href:`https://www.anikore.jp/anime/${t.data.anikoreId}`,target:"_blank"},[C(" Anikore"),d("strong",null,w(t.data.anikoreScore?Number(t.data.anikoreScore).toFixed(2):"--"),1)],8,Ne)):I("v-if",!0)]),d("div",Ve,[He,(y(!0),S(B,null,U(t.data.genres,o=>(y(),S("div",Be,w(o),1))),256))])])])]))}});const F=(t,s)=>{const i=t.__vccOpts||t;for(const[o,e]of s)i[o]=e;return i},ze=F(Ue,[["__scopeId","data-v-b10ceeed"]]),J=t=>(z("data-v-df5d0585"),t=t(),D(),t),De={class:"page"},Ge=J(()=>d("p",{class:"ps"},[C(" 1. 副标题为易于全网搜索资源的外文标题。"),d("br"),C(" 2. 点击蓝色评分数字可以跳转到对应的评分网站，供检查验证。"),d("br"),C(" 3. B ∩ M 为 BGM 与 MAL 的交集数据，A ∩ B ∩ M 同理。 ")],-1)),We=J(()=>d("a",{href:"https://space.bilibili.com/29037910",target:"_blank"},"动漫皮之助@bilibili",-1)),qe=E({__name:"Home",setup(t){const i=T(2),o=[{text:"A ∩ B ∩ M",value:"3"},{text:"B ∩ M",value:"2"}],e=2023,r=Array(e-2021+1).fill(e).map((k,v)=>({text:k-v,value:String(k-v)})),a=M("year",r[0].value),f=M("site"),c=M("genres"),u=T(),l=ye(a,f),[p,m]=ke(l,c),_=R(()=>p.value.slice((i.value-1)*20,i.value*20));function g(){W().then(k=>{$(k?"缓存清理成功":"缓存已清理")})}return(k,v)=>{const j=A("van-dropdown-item"),K=A("van-dropdown-menu"),X=A("van-pagination");return y(),S("div",De,[L(K,null,{default:re(()=>[L(j,{modelValue:h(a),"onUpdate:modelValue":v[0]||(v[0]=b=>x(a)?a.value=b:null),options:h(r)},null,8,["modelValue","options"]),L(j,{modelValue:h(f),"onUpdate:modelValue":v[1]||(v[1]=b=>x(f)?f.value=b:null),options:o},null,8,["modelValue"]),L(j,{modelValue:h(c),"onUpdate:modelValue":v[2]||(v[2]=b=>x(c)?c.value=b:null),options:h(m)},null,8,["modelValue","options"])]),_:1}),d("div",{class:"main safe-bottom",ref_key:"$list",ref:u},[(y(!0),S(B,null,U(h(_),(b,Q)=>(y(),G(ze,{data:b,rank:(i.value-1)*h(20)+Q+1},null,8,["data","rank"]))),256)),L(X,{modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=b=>i.value=b),"total-items":h(p).length,"items-per-page":h(20),"show-page-size":"20",onChange:v[4]||(v[4]=b=>u.value.scrollTop=0)},null,8,["modelValue","total-items","items-per-page"]),Ge,d("p",{class:"b-home"},[d("span",{onClick:g},"勾搭我 👉🏻"),We])],512)])}}});const Fe=F(qe,[["__scopeId","data-v-df5d0585"]]),Je=E({__name:"Me",setup(t){function s(){W().then(i=>{$(i?"操作成功":"已处理")})}return(i,o)=>(y(),S("a",{onClick:s},"清除缓存"))}}),Ye=[{path:"/",redirect:"/rank/3/all/"},{path:"/rank/:site/:genres/:year?",component:Fe},{path:"/me",component:Je}],Ke=oe({history:ae(),routes:Ye}),Xe=E({__name:"App",setup(t){return se(s=>(console.error(s),!1)),(s,i)=>{const o=A("router-view");return y(),G(o)}}});const Qe={t:"1674136366787",class:"bookmark_svg__icon icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2962",width:"200",height:"200"},Ze=d("path",{d:"M256 896a42.666667 42.666667 0 0 1-20.906667-5.546667A42.666667 42.666667 0 0 1 213.333333 853.333333V227.413333A97.28 97.28 0 0 1 307.2 128h409.6A97.28 97.28 0 0 1 810.666667 227.413333V853.333333a42.666667 42.666667 0 0 1-21.333334 36.693334 42.666667 42.666667 0 0 1-42.666666 0l-241.92-136.96-227.413334 136.533333A42.666667 42.666667 0 0 1 256 896z","p-id":"2963"},null,-1),et=[Ze];function Y(t,s){return y(),S("svg",Qe,et)}const tt={render:Y},nt=Object.freeze(Object.defineProperty({__proto__:null,default:tt,render:Y},Symbol.toStringTag,{value:"Module"})),H=Object.assign({"./bookmark.svg":nt}),rt={install(t){Object.keys(H).forEach(s=>{const o=`icon-${/([\w\-]+)\.svg$/.exec(s)[1]}`,e=H[s].default;t.component(o,e)})}};$.setDefaultOptions("loading",{forbidClick:!0,duration:6e4});ie(Xe).use(rt).use(le).use(Ke).mount("#app");fe();
